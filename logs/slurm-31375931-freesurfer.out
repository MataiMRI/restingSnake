Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 16
Rules claiming more threads will be scaled down.
Select jobs to execute...

[Thu Nov 17 08:35:58 2022]
rule freesurfer:
    input: /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/sub-ctrl18/ses-a
    output: /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18-a
    jobid: 0
    wildcards: resultsdir=/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test, subject=ctrl18, session=a
    threads: 16
    resources: mem_mb=20000, disk_mb=1000, tmpdir=/dev/shm/jobs/31375931, cpus=16, time_min=600, gpu=0

export FS_LICENSE="/nesi/project/uoa03264/fmri_workflow/license.txt" ; recon-all -sd /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer -i /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/sub-ctrl18/ses-a/anat/sub-ctrl18_ses-a_run-001_T1w.nii.gz -subjid sub-ctrl18 -all -qcache -3T 
Activating singularity image /scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/singularity/b862ddfcead2bab5771175db9e31b12f.simg
Subject Stamp: freesurfer-Linux-centos6_x86_64-stable-pub-v6.0.1-f53a55a
Current Stamp: freesurfer-Linux-centos6_x86_64-stable-pub-v6.0.1-f53a55a
INFO: SUBJECTS_DIR is /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer
Actual FREESURFER_HOME /opt/freesurfer
Linux wbn064 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
'/opt/freesurfer/bin/recon-all' -> '/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/scripts/recon-all.local-copy'
/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18

 mri_convert /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/sub-ctrl18/ses-a/anat/sub-ctrl18_ses-a_run-001_T1w.nii.gz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig/001.mgz 

mri_convert.bin /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/sub-ctrl18/ses-a/anat/sub-ctrl18_ses-a_run-001_T1w.nii.gz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig/001.mgz 
$Id: mri_convert.c,v 1.226 2016/02/26 16:15:24 mreuter Exp $
reading from /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/sub-ctrl18/ses-a/anat/sub-ctrl18_ses-a_run-001_T1w.nii.gz...
TR=6.80, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (0.99987, 0.00074297, -0.016124)
j_ras = (-0.00194138, 0.997224, -0.0744354)
k_ras = (0.0160239, 0.074457, 0.997095)
writing to /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig/001.mgz...
#--------------------------------------------
#@# MotionCor Wed Nov 16 19:37:07  2022
Found 1 runs
/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig/001.mgz
Checking for (invalid) multi-frame inputs...
WARNING: only one run found. This is OK, but motion
correction cannot be performed on one run, so I'll
copy the run to rawavg and continue.

 cp /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig/001.mgz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/rawavg.mgz 

/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18

 mri_convert /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/rawavg.mgz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig.mgz --conform 

mri_convert.bin /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/rawavg.mgz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig.mgz --conform 
$Id: mri_convert.c,v 1.226 2016/02/26 16:15:24 mreuter Exp $
reading from /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/rawavg.mgz...
TR=6.80, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (0.99987, 0.00074297, -0.016124)
j_ras = (-0.00194138, 0.997224, -0.0744354)
k_ras = (0.0160239, 0.074457, 0.997095)
changing data type from float to uchar (noscale = 0)...
MRIchangeType: Building histogram 
Reslicing using trilinear interpolation 
writing to /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig.mgz...

 mri_add_xform_to_header -c /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/transforms/talairach.xfm /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig.mgz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/orig.mgz 

INFO: extension is mgz
#--------------------------------------------
#@# Talairach Wed Nov 16 19:37:30  2022
/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri

 mri_nu_correct.mni --no-rescale --i orig.mgz --o orig_nu.mgz --n 1 --proto-iters 1000 --distance 50 

/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri
/opt/freesurfer/bin/mri_nu_correct.mni
--no-rescale --i orig.mgz --o orig_nu.mgz --n 1 --proto-iters 1000 --distance 50
nIters 1
$Id: mri_nu_correct.mni,v 1.27 2016/02/26 16:19:49 mreuter Exp $
Linux wbn064 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
Wed Nov 16 19:37:30  2022
Program nu_correct, built from:
Package MNI N3, version 1.12.0, compiled by nicks@terrier (x86_64-unknown-linux-gnu) on 2015-06-19 at 01:25:34
/usr/bin/bc
tmpdir is ./tmp.mri_nu_correct.mni.70413
/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri
mri_convert orig.mgz ./tmp.mri_nu_correct.mni.70413/nu0.mnc -odt float
mri_convert.bin orig.mgz ./tmp.mri_nu_correct.mni.70413/nu0.mnc -odt float 
$Id: mri_convert.c,v 1.226 2016/02/26 16:15:24 mreuter Exp $
reading from orig.mgz...
TR=6.80, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (-1, 1.16415e-10, 0)
j_ras = (0, -7.45058e-09, -1)
k_ras = (-1.16415e-10, 1, 7.45058e-09)
changing data type from uchar to float (noscale = 0)...
writing to ./tmp.mri_nu_correct.mni.70413/nu0.mnc...
 
--------------------------------------------------------
Iteration 1 Wed Nov 16 19:37:31  2022
nu_correct -clobber ./tmp.mri_nu_correct.mni.70413/nu0.mnc ./tmp.mri_nu_correct.mni.70413/nu1.mnc -tmpdir ./tmp.mri_nu_correct.mni.70413/0/ -iterations 1000 -distance 50
[jmcg465@wbn064:/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/] [2022-11-16 19:37:31] running:
  /opt/freesurfer/mni/bin/nu_estimate_np_and_em -parzen -log -sharpen 0.15 0.01 -iterations 1000 -stop 0.001 -shrink 4 -auto_mask -nonotify -b_spline 1.0e-7 -distance 50 -quiet -execute -clobber -nokeeptmp -tmpdir ./tmp.mri_nu_correct.mni.70413/0/ ./tmp.mri_nu_correct.mni.70413/nu0.mnc ./tmp.mri_nu_correct.mni.70413/nu1.imp

Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Number of iterations: 37 
CV of field change: 0.000969986
 
 
 
mri_convert ./tmp.mri_nu_correct.mni.70413/nu1.mnc orig_nu.mgz --like orig.mgz --conform
mri_convert.bin ./tmp.mri_nu_correct.mni.70413/nu1.mnc orig_nu.mgz --like orig.mgz --conform 
$Id: mri_convert.c,v 1.226 2016/02/26 16:15:24 mreuter Exp $
reading from ./tmp.mri_nu_correct.mni.70413/nu1.mnc...
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (-1, 1.16415e-10, 0)
j_ras = (0, -7.45058e-09, -1)
k_ras = (-1.16415e-10, 1, 7.45058e-09)
INFO: transform src into the like-volume: orig.mgz
changing data type from float to uchar (noscale = 0)...
MRIchangeType: Building histogram 
writing to orig_nu.mgz...
 
 
Wed Nov 16 19:38:24  2022
mri_nu_correct.mni done

 talairach_avi --i orig_nu.mgz --xfm transforms/talairach.auto.xfm --atlas 3T18yoSchwartzReactN32_as_orig 

talairach_avi log file is transforms/talairach_avi.log...
Started at Wed Nov 16 19:38:24 2022
Ended   at Wed Nov 16 19:38:44  2022
talairach_avi done

 cp transforms/talairach.auto.xfm transforms/talairach.xfm 

#--------------------------------------------
#@# Talairach Failure Detection Wed Nov 16 19:38:46  2022
/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri

 talairach_afd -T 0.005 -xfm transforms/talairach.xfm 

talairach_afd: Talairach Transform: transforms/talairach.xfm OK (p=0.6845, pval=0.4932 >= threshold=0.0050)

 awk -f /opt/freesurfer/bin/extract_talairach_avi_QA.awk /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/transforms/talairach_avi.log 


 tal_QC_AZS /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/transforms/talairach_avi.log 

TalAviQA: 0.96439
z-score: -3
#--------------------------------------------
#@# Nu Intensity Correction Wed Nov 16 19:38:46  2022

 mri_nu_correct.mni --i orig.mgz --o nu.mgz --uchar transforms/talairach.xfm --proto-iters 1000 --distance 50 --n 1 

/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri
/opt/freesurfer/bin/mri_nu_correct.mni
--i orig.mgz --o nu.mgz --uchar transforms/talairach.xfm --proto-iters 1000 --distance 50 --n 1
nIters 1
$Id: mri_nu_correct.mni,v 1.27 2016/02/26 16:19:49 mreuter Exp $
Linux wbn064 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
Wed Nov 16 19:38:46  2022
Program nu_correct, built from:
Package MNI N3, version 1.12.0, compiled by nicks@terrier (x86_64-unknown-linux-gnu) on 2015-06-19 at 01:25:34
/usr/bin/bc
tmpdir is ./tmp.mri_nu_correct.mni.72079
/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri
mri_convert orig.mgz ./tmp.mri_nu_correct.mni.72079/nu0.mnc -odt float
mri_convert.bin orig.mgz ./tmp.mri_nu_correct.mni.72079/nu0.mnc -odt float 
$Id: mri_convert.c,v 1.226 2016/02/26 16:15:24 mreuter Exp $
reading from orig.mgz...
TR=6.80, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (-1, 1.16415e-10, 0)
j_ras = (0, -7.45058e-09, -1)
k_ras = (-1.16415e-10, 1, 7.45058e-09)
changing data type from uchar to float (noscale = 0)...
writing to ./tmp.mri_nu_correct.mni.72079/nu0.mnc...
 
--------------------------------------------------------
Iteration 1 Wed Nov 16 19:38:47  2022
nu_correct -clobber ./tmp.mri_nu_correct.mni.72079/nu0.mnc ./tmp.mri_nu_correct.mni.72079/nu1.mnc -tmpdir ./tmp.mri_nu_correct.mni.72079/0/ -iterations 1000 -distance 50
[jmcg465@wbn064:/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test/bids/derivatives/freesurfer/sub-ctrl18/mri/] [2022-11-16 19:38:47] running:
  /opt/freesurfer/mni/bin/nu_estimate_np_and_em -parzen -log -sharpen 0.15 0.01 -iterations 1000 -stop 0.001 -shrink 4 -auto_mask -nonotify -b_spline 1.0e-7 -distance 50 -quiet -execute -clobber -nokeeptmp -tmpdir ./tmp.mri_nu_correct.mni.72079/0/ ./tmp.mri_nu_correct.mni.72079/nu0.mnc ./tmp.mri_nu_correct.mni.72079/nu1.imp

Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Processing:.................................................................Done
Number of iterations: 37 
CV of field change: 0.000969986
slurmstepd: error: *** JOB 31375931 ON wbn064 CANCELLED AT 2022-11-16T19:39:35 ***
