Building DAG of jobs...
Your conda installation is not configured to use strict channel priorities. This is however crucial for having robust and correct environments (for details, see https://conda-forge.org/docs/user/tipsandtricks.html). Please consider to configure strict priorities by executing 'conda config --set channel_priority strict'.
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=16000, mem_mib=15259, disk_mb=1000, disk_mib=954, cpus=2, time_min=10, gpu=0
Select jobs to execute...

[Tue Mar 14 11:53:19 2023]
rule first_level:
    input: /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1
    output: /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/first_level_results/sub-rugby1/ses-a/sub-rugby1_ses-a_DMN_unthresholded_fc.nii.gz, /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/first_level_results/sub-rugby1/ses-a/sub-rugby1_ses-a_DMN_figure.png
    jobid: 0
    reason: Missing output files: /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/first_level_results/sub-rugby1/ses-a/sub-rugby1_ses-a_DMN_figure.png, /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/first_level_results/sub-rugby1/ses-a/sub-rugby1_ses-a_DMN_unthresholded_fc.nii.gz
    wildcards: resultsdir=/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh, subject=rugby1, session=a, network=DMN
    resources: mem_mb=16000, mem_mib=15259, disk_mb=1000, disk_mib=954, tmpdir=/dev/shm/jobs/33430856, cpus=2, time_min=10, gpu=0

python ./scripts/first_level_prob_atlas_hcp1.py /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1/ses-a/func/sub-rugby1_ses-a_task-rest_run-001_space-MNI152NLin2009cAsym_res-2_desc-brain_mask.nii.gz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1/ses-a/func/sub-rugby1_ses-a_task-rest_run-001_space-MNI152NLin2009cAsym_res-2_desc-preproc_bold.nii.gz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1/ses-a/func/sub-rugby1_ses-a_task-rest_run-001_desc-confounds_timeseries.tsv /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/first_level_results/sub-rugby1/ses-a/sub-rugby1_ses-a_DMN_unthresholded_fc.nii.gz /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/first_level_results/sub-rugby1/ses-a/sub-rugby1_ses-a_DMN_figure.png -a_img ./atlas/MSDL_rois/msdl_rois.nii -a_lab ./atlas/MSDL_rois/msdl_rois_labels.csv -tr 1.5 -rg csf white_matter trans_x trans_y trans_z rot_x rot_y rot_z -ntwk DMN -hp 0.01 -lp 0.1 -fwhm 6 -fdr 0.01 -fc 0.25 -v
Activating conda environment: .snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_
/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/site-packages/nilearn/datasets/__init__.py:93: FutureWarning: Fetchers from the nilearn.datasets module will be updated in version 0.9 to return python strings instead of bytes and Pandas dataframes instead of Numpy arrays.
  warn("Fetchers from the nilearn.datasets module will be "
2023-03-14 11:53:21,709 :: root :: INFO :: Loading mask image (3D): /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1/ses-a/func/sub-rugby1_ses-a_task-rest_run-001_space-MNI152NLin2009cAsym_res-2_desc-brain_mask.nii.gz
2023-03-14 11:53:21,711 :: root :: INFO :: Loading resting-state fMRI image (4D): /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1/ses-a/func/sub-rugby1_ses-a_task-rest_run-001_space-MNI152NLin2009cAsym_res-2_desc-preproc_bold.nii.gz
2023-03-14 11:53:21,711 :: root :: INFO :: This image was collected with a TR of: 1.5
2023-03-14 11:53:21,827 :: root :: INFO :: Loading timeseries for confounding variables from: /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1/ses-a/func/sub-rugby1_ses-a_task-rest_run-001_desc-confounds_timeseries.tsv
2023-03-14 11:53:21,851 :: root :: INFO :: Confound regressors that will be cleaned from signal:

             csf  white_matter   trans_x   trans_y   trans_z     rot_x     rot_y     rot_z
0    3038.984613   1821.770151  0.003837 -0.091585 -0.065512  0.000292  0.000519 -0.000510
1    3037.404964   1818.325083  0.000223 -0.060436 -0.052096 -0.000616  0.000447 -0.000510
2    3027.356924   1814.131600  0.017754 -0.053072 -0.095969 -0.000035  0.000447 -0.000510
3    3027.077838   1816.651055 -0.011414 -0.029825 -0.031433 -0.000699  0.000502 -0.000510
4    3024.171771   1814.762574  0.005794 -0.058813 -0.093091 -0.000044  0.000447 -0.000947
..           ...           ...       ...       ...       ...       ...       ...       ...
195  3036.572650   1822.883046 -0.092422  0.219119 -0.122565  0.003940  0.002200 -0.000149
196  3046.831335   1824.533307 -0.055303  0.199684 -0.249764  0.004364  0.002419 -0.000295
197  3048.399767   1826.047678 -0.090581  0.220075 -0.143917  0.003886  0.002181 -0.000408
198  3040.344301   1825.402275 -0.066922  0.196825 -0.206508  0.004296  0.002282 -0.000481
199  3042.197332   1825.293297 -0.075755  0.222183 -0.184093  0.004016  0.002012 -0.000457

[200 rows x 8 columns]
2023-03-14 11:53:21,851 :: root :: INFO :: Loading regions-of-interest from atlas provided
2023-03-14 11:53:21,853 :: root :: INFO :: Functional networks available in atlas:
2023-03-14 11:53:21,853 :: root :: INFO :: DMN
2023-03-14 11:53:21,853 :: root :: INFO :: Dors PCC
2023-03-14 11:53:21,853 :: root :: INFO :: Cing-Ins
2023-03-14 11:53:21,853 :: root :: INFO :: Striate
2023-03-14 11:53:21,853 :: root :: INFO :: Motor
2023-03-14 11:53:21,854 :: root :: INFO :: Basal
2023-03-14 11:53:21,854 :: root :: INFO :: L V Att
2023-03-14 11:53:21,854 :: root :: INFO :: R V Att
2023-03-14 11:53:21,854 :: root :: INFO :: Ant IPS
2023-03-14 11:53:21,854 :: root :: INFO :: Aud
2023-03-14 11:53:21,854 :: root :: INFO :: Temporal
2023-03-14 11:53:21,854 :: root :: INFO :: D Att
2023-03-14 11:53:21,854 :: root :: INFO :: Vis Sec
2023-03-14 11:53:21,854 :: root :: INFO :: Cereb
2023-03-14 11:53:21,854 :: root :: INFO :: Salience
2023-03-14 11:53:21,854 :: root :: INFO :: Language
2023-03-14 11:53:21,854 :: root :: INFO :: Occ post
2023-03-14 11:53:21,854 :: root :: INFO :: 
Details about seed(s) within selected network
--- Logging error ---
Traceback (most recent call last):
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 1083, in emit
    msg = self.format(record)
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 927, in format
    return fmt.format(record)
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 663, in format
    record.message = record.getMessage()
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 367, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/./scripts/first_level_prob_atlas_hcp1.py", line 193, in <module>
    logging.info('\n', roi_labels.iloc[coord])
Message: '\n'
Arguments: (x           -45.8
y          -64.78
z           31.84
name        L DMN
net_name      DMN
Name: 3, dtype: object,)
--- Logging error ---
Traceback (most recent call last):
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 1083, in emit
    msg = self.format(record)
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 927, in format
    return fmt.format(record)
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 663, in format
    record.message = record.getMessage()
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 367, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/./scripts/first_level_prob_atlas_hcp1.py", line 193, in <module>
    logging.info('\n', roi_labels.iloc[coord])
Message: '\n'
Arguments: (x              -0.2
y            -55.21
z             29.87
name        Med DMN
net_name        DMN
Name: 4, dtype: object,)
--- Logging error ---
Traceback (most recent call last):
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 1083, in emit
    msg = self.format(record)
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 927, in format
    return fmt.format(record)
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 663, in format
    record.message = record.getMessage()
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 367, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/./scripts/first_level_prob_atlas_hcp1.py", line 193, in <module>
    logging.info('\n', roi_labels.iloc[coord])
Message: '\n'
Arguments: (x               -0.15
y               51.42
z                7.58
name        Front DMN
net_name          DMN
Name: 5, dtype: object,)
--- Logging error ---
Traceback (most recent call last):
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 1083, in emit
    msg = self.format(record)
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 927, in format
    return fmt.format(record)
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 663, in format
    record.message = record.getMessage()
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/logging/__init__.py", line 367, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Call stack:
  File "/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/./scripts/first_level_prob_atlas_hcp1.py", line 193, in <module>
    logging.info('\n', roi_labels.iloc[coord])
Message: '\n'
Arguments: (x           51.66
y          -59.34
z           28.88
name        R DMN
net_name      DMN
Name: 6, dtype: object,)
2023-03-14 11:53:21,933 :: root :: INFO :: Shape of network nodes from atlas image (40, 48, 35, 4)
/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/site-packages/nilearn/plotting/img_plotting.py:341: FutureWarning: Default resolution of the MNI template will change from 2mm to 1mm in version 0.10.0
  anat_img = load_mni152_template()
/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/site-packages/numpy/ma/core.py:2826: UserWarning: Warning: converting a masked element to nan.
  _data = np.array(data, dtype=dtype, copy=copy,
2023-03-14 11:53:24,482 :: root :: INFO :: BOLD signal will be standardized, detrended, and cleaned based with a Bandpass filter set to 0.1-0.01 Hz and a 6 mm full-width-half-maximum smoothing kernel 

2023-03-14 11:53:24,482 :: root :: INFO :: Generating mask for network of interest based on seed coordinates in atlas
/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/site-packages/nilearn/image/image.py:1106: FutureWarning: The parameter "sessions" will be removed in 0.9.0 release of Nilearn. Please use the parameter "runs" instead.
  data = signal.clean(
/scale_wlg_persistent/filesets/project/uoa03264/fmri_workflow/.snakemake/conda/77cd6f8bc7354c0aed9f21ce8b6acbbb_/lib/python3.9/site-packages/nilearn/_utils/cache_mixin.py:303: UserWarning: memory_level is currently set to 0 but a Memory object has been provided. Setting memory_level to 1.
  warnings.warn("memory_level is currently set to 0 but "
2023-03-14 11:53:38,223 :: root :: INFO :: Converting functional network data to timeseries with shape: (%s, %s)" % network_time_series.shape
2023-03-14 11:53:38,224 :: root :: INFO :: Generating mask for whole brain
2023-03-14 11:54:07,033 :: root :: INFO :: Converting whole brain data to timeseries with shape: (%s, %s)" % brain_time_series.shape
2023-03-14 11:54:07,034 :: root :: INFO :: Performing network to voxel correlation analysis
2023-03-14 11:54:07,126 :: root :: INFO :: Network-to-voxel correlation shape: (229483, 4)
2023-03-14 11:54:07,127 :: root :: INFO :: Network-to-voxel correlation: min = -0.820; max = 0.971
2023-03-14 11:54:07,416 :: root :: INFO :: Performing False Discovery Rate correction
2023-03-14 11:54:07,894 :: root :: INFO :: Saving UNTHRESHOLDED image to /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/first_level_results/sub-rugby1/ses-a/sub-rugby1_ses-a_DMN_unthresholded_fc.nii.gz
2023-03-14 11:54:08,074 :: root :: INFO :: Saving plot of DMN connectivity THRESHOLDED at 0.25 to /nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/first_level_results/sub-rugby1/ses-a/sub-rugby1_ses-a_DMN_figure.png
[NiftiMasker.fit] Loading data from None
[NiftiMasker.fit] Resampling mask
________________________________________________________________________________
[Memory] Calling nilearn.input_data.nifti_masker.filter_and_mask...
filter_and_mask('/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1/ses-a/func/sub-rugby1_ses-a_task-rest_run-001_space-MNI152NLin2009cAsym_res-2_desc-preproc_bold.nii.gz', 
<nibabel.nifti1.Nifti1Image object at 0x15553faae3a0>, { 'detrend': True,
  'dtype': None,
  'high_pass': 0.01,
  'high_variance_confounds': False,
  'low_pass': 0.1,
  'reports': True,
  'runs': None,
  'smoothing_fwhm': 6,
  'standardize': True,
  'standardize_confounds': True,
  't_r': 1.5,
  'target_affine': None,
  'target_shape': None}, memory_level=1, memory=Memory(location=nilearn_cache/joblib), verbose=1, confounds=[ array([[ 3.038985e+03, ..., -5.102550e-04],
       ...,
       [ 3.042197e+03, ..., -4.567550e-04]])], sample_mask=None, copy=True, dtype=None)
[NiftiMasker.transform_single_imgs] Loading data from Nifti1Image('/nesi/nobackup/uoa03264/fMRIpipeline_data/processed_test_josh/bids/derivatives/fmriprep/sub-rugby1/ses-a/func/sub-rugby1_ses-a_task-rest_run-001_space-MNI152NLin2009cAsym_res-2_desc-preproc_bold.nii.gz')
[NiftiMasker.transform_single_imgs] Smoothing images
[NiftiMasker.transform_single_imgs] Extracting region signals
[NiftiMasker.transform_single_imgs] Cleaning extracted signals
_________________________________________________filter_and_mask - 28.8s, 0.5min
________________________________________________________________________________
[Memory] Calling nilearn.masking.unmask...
unmask(array([[-0.277604, ..., -0.326635],
       ...,
       [-0.234684, ..., -0.286474]]), 
<nibabel.nifti1.Nifti1Image object at 0x15553faae3a0>)
___________________________________________________________unmask - 0.2s, 0.0min
[Tue Mar 14 11:54:09 2023]
Finished job 0.
1 of 1 steps (100%) done
